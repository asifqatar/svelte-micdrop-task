import{s as H,e as D,a as T,b as k,d as M,g as I,f as g,h as w,i as S,j as b,m as P,L as J,t as C,o as F,n as W,y as K,p as L}from"./scheduler.CiCf2nRa.js";import{S as Q,i as R,t as E,g as O,f as z,a as B,c as X,b as Z,m as ee,d as te}from"./index.DcvOW0q_.js";import{e as x}from"./each.CyCXCkPQ.js";import{B as re}from"./Badge.DIHtCMTo.js";import{f as ne}from"./format.C6z4YYgV.js";import{g as le,a as ae,s as oe}from"./getDaysInMonth.GrxyPocX.js";let V=[];async function se(){try{const a=await fetch("/api/getEventsForVenue");if(a.ok){const e=await a.json();return console.log("Fetched events:",e),e.map(r=>({id:r.ID,date:r.startDateTime,title:r.title}))}else return console.error("Failed to load events:",a.status),[]}catch(a){return console.error("Error fetching events:",a),[]}}async function ce(a,e){return V=await se(),new Promise(r=>{setTimeout(()=>{r(V.filter(n=>n.date.startsWith(`${a}-${String(e).padStart(2,"0")}`)))},500)})}function Y(a,e,r){const n=a.slice();return n[9]=e[r],n}function U(a,e,r){const n=a.slice();return n[12]=e[r],n}function j(a,e,r){const n=a.slice();return n[15]=e[r],n}function ie(a,e,r){const n=a.slice();return n[18]=e[r],n}function fe(a){let e,r;return{c(){e=D("span"),r=C(a[18]),this.h()},l(n){e=k(n,"SPAN",{class:!0});var i=M(e);r=F(i,a[18]),i.forEach(g),this.h()},h(){w(e,"class","flex p-3 items-center justify-center gap-3 bg-BG-Primary text-Text-Tertiary leading-[18px] font-normal text-[14px] sm:text-lg border-l border-stroke-Primary")},m(n,i){S(n,e,i),b(e,r)},p:W,d(n){n&&g(e)}}}function $(a){let e;return{c(){e=D("div"),this.h()},l(r){e=k(r,"DIV",{class:!0}),M(e).forEach(g),this.h()},h(){w(e,"class","svelte-obmsx5")},m(r,n){S(r,e,n)},p:W,d(r){r&&g(e)}}}function ue(a){let e=a[12].title+"",r,n;return{c(){r=C(e),n=T()},l(i){r=F(i,e),n=I(i)},m(i,h){S(i,r,h),S(i,n,h)},p(i,h){h&1&&e!==(e=i[12].title+"")&&L(r,e)},d(i){i&&(g(r),g(n))}}}function q(a){let e,r;return e=new re({props:{event:"squareEvent",eventBgColor:"hsla(0, 0%, 100%, 1)",eventTextColor:"hsla(220, 20%, 18%, 1)",$$slots:{default:[ue]},$$scope:{ctx:a}}}),{c(){X(e.$$.fragment)},l(n){Z(e.$$.fragment,n)},m(n,i){ee(e,n,i),r=!0},p(n,i){const h={};i&2097153&&(h.$$scope={dirty:i,ctx:n}),e.$set(h)},i(n){r||(E(e.$$.fragment,n),r=!0)},o(n){B(e.$$.fragment,n),r=!1},d(n){te(e,n)}}}function G(a){let e,r,n=a[9].day+"",i,h,_,m,d,u,p,c=x(a[9].events),f=[];for(let o=0;o<c.length;o+=1)f[o]=q(U(a,c,o));const y=o=>B(f[o],1,1,()=>{f[o]=null});function l(){return a[5](a[9])}return{c(){e=D("div"),r=D("span"),i=C(n),h=T(),_=D("div");for(let o=0;o<f.length;o+=1)f[o].c();m=T(),this.h()},l(o){e=k(o,"DIV",{class:!0});var s=M(e);r=k(s,"SPAN",{class:!0});var t=M(r);i=F(t,n),t.forEach(g),h=I(s),_=k(s,"DIV",{class:!0});var v=M(_);for(let A=0;A<f.length;A+=1)f[A].l(v);v.forEach(g),m=I(s),s.forEach(g),this.h()},h(){w(r,"class","day svelte-obmsx5"),w(_,"class","mt-1 w-full flex flex-col items-center gap-1 p-1"),w(e,"class","day-container text-[#252B37] flex flex-col items-center svelte-obmsx5")},m(o,s){S(o,e,s),b(e,r),b(r,i),b(e,h),b(e,_);for(let t=0;t<f.length;t+=1)f[t]&&f[t].m(_,null);b(e,m),d=!0,u||(p=K(e,"click",l),u=!0)},p(o,s){if(a=o,(!d||s&1)&&n!==(n=a[9].day+"")&&L(i,n),s&1){c=x(a[9].events);let t;for(t=0;t<c.length;t+=1){const v=U(a,c,t);f[t]?(f[t].p(v,s),E(f[t],1)):(f[t]=q(v),f[t].c(),E(f[t],1),f[t].m(_,null))}for(O(),t=c.length;t<f.length;t+=1)y(t);z()}},i(o){if(!d){for(let s=0;s<c.length;s+=1)E(f[s]);d=!0}},o(o){f=f.filter(Boolean);for(let s=0;s<f.length;s+=1)B(f[s]);d=!1},d(o){o&&g(e),P(f,o),u=!1,p()}}}function he(a){var y;let e,r,n,i,h,_=x(["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]),m=[];for(let l=0;l<7;l+=1)m[l]=fe(ie(a,_,l));let d=x(Array(((y=a[0][0])==null?void 0:y.startDay)||0).fill().map(N)),u=[];for(let l=0;l<d.length;l+=1)u[l]=$(j(a,d,l));let p=x(a[0]),c=[];for(let l=0;l<p.length;l+=1)c[l]=G(Y(a,p,l));const f=l=>B(c[l],1,1,()=>{c[l]=null});return{c(){e=D("div"),r=D("div");for(let l=0;l<7;l+=1)m[l].c();n=T();for(let l=0;l<u.length;l+=1)u[l].c();i=T();for(let l=0;l<c.length;l+=1)c[l].c();this.h()},l(l){e=k(l,"DIV",{class:!0});var o=M(e);r=k(o,"DIV",{class:!0});var s=M(r);for(let t=0;t<7;t+=1)m[t].l(s);n=I(s);for(let t=0;t<u.length;t+=1)u[t].l(s);i=I(s);for(let t=0;t<c.length;t+=1)c[t].l(s);s.forEach(g),o.forEach(g),this.h()},h(){w(r,"class","calendar w-full overflow-hidden mx-auto grid rounded-lg border-t border-r border-b border-stroke-Primary svelte-obmsx5"),w(e,"class","max-w-[1200px] overflow-hidden mx-auto w-full bg-BG-Primary my-4")},m(l,o){S(l,e,o),b(e,r);for(let s=0;s<7;s+=1)m[s]&&m[s].m(r,null);b(r,n);for(let s=0;s<u.length;s+=1)u[s]&&u[s].m(r,null);b(r,i);for(let s=0;s<c.length;s+=1)c[s]&&c[s].m(r,null);h=!0},p(l,[o]){var s;if(o&1){d=x(Array(((s=l[0][0])==null?void 0:s.startDay)||0).fill().map(N));let t;for(t=0;t<d.length;t+=1){const v=j(l,d,t);u[t]?u[t].p(v,o):(u[t]=$(),u[t].c(),u[t].m(r,i))}for(;t<u.length;t+=1)u[t].d(1);u.length=d.length}if(o&3){p=x(l[0]);let t;for(t=0;t<p.length;t+=1){const v=Y(l,p,t);c[t]?(c[t].p(v,o),E(c[t],1)):(c[t]=G(v),c[t].c(),E(c[t],1),c[t].m(r,null))}for(O(),t=p.length;t<c.length;t+=1)f(t);z()}},i(l){if(!h){for(let o=0;o<p.length;o+=1)E(c[o]);h=!0}},o(l){c=c.filter(Boolean);for(let o=0;o<c.length;o+=1)B(c[o]);h=!1},d(l){l&&g(e),P(m,l),P(u,l),P(c,l)}}}const N=()=>"";function de(a,e,r){let{currentYear:n}=e,{currentMonth:i}=e,h,_=[],m=[];async function d(){const c=le(h),f=ae(oe(h));r(0,_=Array.from({length:c},(y,l)=>({day:l+1,startDay:f+l,events:[]}))),m=await ce(n,i+1),r(0,_=_.map(y=>(y.events=m.filter(l=>{const o=new Date(l.date);return o.getUTCFullYear()===n&&o.getUTCMonth()===i&&o.getUTCDate()===y.day}),y)))}J(d);function u(c){String(c).padStart(2,"0"),String(i+1).padStart(2,"0")}const p=c=>u(c.day);return a.$$set=c=>{"currentYear"in c&&r(2,n=c.currentYear),"currentMonth"in c&&r(3,i=c.currentMonth)},a.$$.update=()=>{a.$$.dirty&12&&r(4,h=new Date(Date.UTC(n,i,1))),a.$$.dirty&16&&ne(h,"MMMM"),a.$$.dirty&12&&n&&i!==void 0&&d()},[_,u,n,i,h,p]}class be extends Q{constructor(e){super(),R(this,e,de,he,H,{currentYear:2,currentMonth:3})}}export{be as M};
